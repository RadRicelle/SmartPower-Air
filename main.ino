#include <IRremote.h>
#include <dht.h>

#define dht_dpin A3 //Pino DATA do Sensor ligado na porta Analogica A3

dht DHT; //Inicializa o sensor de Temperatura e umidade
int rele = 12;
IRsend irsend; // Sensor IR
unsigned int powerOn[381]={6048, 7416, 516, 3496, 540, 3488, 540, 3492, 512, 1500, 516, 3488, 544, 1496, 516, 3488, 540, 3492, 540, 1472, 520, 1496, 516, 1496, 
520, 3512, 520, 1472, 540, 3488, 516, 1500, 516, 1496, 544, 1496, 520, 3512, 520, 3488, 516, 3512, 544, 1472, 540, 3492, 516, 3492, 536, 3492, 540, 3492, 540, 
1472, 544, 1472, 516, 1496, 516, 3492, 540, 1476, 536, 1476, 540, 1476, 540, 1472, 540, 3492, 512, 1504, 512, 3516, 512, 1504, 512, 3524, 484, 1552, 460, 1532, 
480, 3556, 476, 1536, 452, 3668, 364, 1660, 352, 42552, 6044, 7416, 544, 3488, 516, 3516, 516, 3512, 520, 1496, 520, 3488, 516, 1496, 520, 3512, 516, 3516, 516, 
1496, 516, 1476, 516, 1496, 516, 3516, 540, 1472, 520, 3512, 516, 1476, 540, 1472, 564, 1500, 516, 3492, 540, 3492, 540, 1472, 540, 1476, 540, 3468, 536, 3492, 
540, 3492, 540, 3492, 512, 1504, 508, 1504, 512, 3520, 484, 3572, 460, 1556, 456, 1560, 456, 1532, 456, 1560, 480, 3584, 424, 1596, 416, 34476, 2916, 172, 1104, 
224, 1180, 47336, 6044, 7568, 360, 1684, 6016, 7444, 512, 3496, 536, 3496, 536, 3492, 512, 1504, 512, 3520, 484, 1528, 488, 3568, 464, 3600, 404, 1616, 424, 1588, 
400, 1592, 420, 20524, 6064, 7416, 516, 3492, 544, 3488, 540, 3488, 520, 1496, 516, 3492, 540, 1496, 520, 3488, 540, 3488, 544, 1472, 520, 1496, 516, 1496, 520, 3512, 
520, 1472, 536, 3492, 540, 1476, 516, 1496, 544, 1496, 520, 3512, 520, 3488, 536, 1476, 540, 1476, 540, 3492, 520, 3508, 516, 3492, 540, 3492, 540, 1472, 540, 1476, 540, 
3492, 512, 3516, 516, 1500, 512, 1500, 516, 1500, 512, 1504, 512, 3520, 484, 1528, 484, 3548, 460, 1556, 460, 3608, 420, 1620, 396, 1620, 368, 32900, 5992, 7416, 520, 3496, 
536, 3488, 544, 3488, 516, 1500, 516, 3492, 536, 1500, 516, 3488, 540, 3492, 516, 1496, 520, 1496, 520, 1492, 520, 3512, 520, 1472, 540, 3488, 544, 1472, 520, 1496, 544, 1496, 
516, 3512, 520, 3488, 516, 3512, 520, 1496, 520, 3512, 516, 3492, 536, 3492, 544, 3488, 544, 1472, 540, 1472, 516, 1500, 516, 3488, 544, 1472, 540, 1472, 544, 1472, 540, 1476, 
540, 3488, 516, 1500, 512, 3492, 540, 1476, 540, 3516, 512, 1504, 484, 1528, 488, 3520, 512, 1504, 484, 3572, 456, 1560, 456, 3640, 364, 1676, 340}; // Código Raw para ligar/desligar o ar-condicionado model:yang


void setup(){
  Serial.begin(9600);
  delay(1000);	//Aguarda 1 seg antes de acessar as informações do sensor
}


void loop()
{
  DHT.read11(dht_dpin); //Lê as informações do sensor de Temperatura
  
  //Exibir status no monitor serial
  Serial.print("Umidade = ");
  Serial.print(DHT.humidity);
  Serial.print(" %  ");
  Serial.print("Temperatura = ");
  Serial.print(DHT.temperature); 
  Serial.println(" Celsius  ");
  
    if (DHT.temperature >= 23){
      digitalWrite(rele,HIGH); 
      irsend.sendRaw(powerOn,381,38);
      Serial.print("Emitindo sinal IR");
      delay(2000);//8 segundos até o próximo sinal IR ser enviado
      }
    
    else digitalWrite
      (rele,LOW);
      


  //Intervalo de leitura
  delay(2000);  
}
